{% block title %}
最終結果
{% endblock %}

{% block content %}
<div class="container">
    <h4>実験結果</h4>
    <div class="alert alert-info">
        <p>あなたは{{ role }}役でした。</p>
    </div>

    <h4>報酬計算に選ばれたラウンド</h4>
    {% for round in rounds_info %}
    <div class="card mb-3">
        <div class="card-header">
            ラウンド {{ round.round_number }}
            {% if round.is_final_prediction %}
            <span class="badge badge-info">追加ラウンド</span>
            {% endif %}
        </div>
        <div class="card-body">
            <table class="table">
                <tr>
                    <th>選択肢</th>
                    <th>A役の報酬</th>
                    <th>B役の報酬</th>
                </tr>
                <tr>
                    <td>X</td>
                    <td>{{ round.payoff_x_a }}</td>
                    <td>{{ round.payoff_x_b }}</td>
                </tr>
                <tr>
                    <td>Y</td>
                    <td>{{ round.payoff_y_a }}</td>
                    <td>{{ round.payoff_y_b }}</td>
                </tr>
            </table>
            <p>A役の選択: <strong>{{ round.choice }}</strong></p>
            <p>獲得報酬: <strong>{{ round.payoff }}ポイント</strong></p>
        </div>
    </div>
    {% endfor %}

    <h4>最終報酬</h4>
    <div class="alert alert-success">
        <div class="mb-3">
            <h5>報酬の内訳</h5>
            <ul class="list-unstyled">
                <li>1回目のラウンド: <strong>{{ rounds_info.0.payoff }}</strong> ポイント</li>
                <li>2回目のラウンド: <strong>{{ rounds_info.1.payoff }}</strong> ポイント</li>
            </ul>
        </div>
        <hr>
        <h5>合計報酬: <strong>{{ total_game_payoff }}</strong> ポイント</h5>
        <small class="text-muted">（計算式: {{ rounds_info.0.payoff }} + {{ rounds_info.1.payoff }} = {{ total_game_payoff }}）</small>
    </div>

    {% next_button %}
</div>
{% endblock %} 